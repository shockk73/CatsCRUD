(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{27:function(e,t,a){e.exports=a(40)},32:function(e,t,a){},40:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(16),l=a.n(c),u=(a(32),a(9)),s=a(12),o=a(1),i=a.n(o),m=a(4),d=function(){return r.a.createElement("div",null,r.a.createElement("div",{className:"preloader-wrapper active"},r.a.createElement("div",{className:"spinner-layer spinner-red-only"},r.a.createElement("div",{className:"circle-clipper left"},r.a.createElement("div",{className:"circle"})),r.a.createElement("div",{className:"gap-patch"},r.a.createElement("div",{className:"circle"})),r.a.createElement("div",{className:"circle-clipper right"},r.a.createElement("div",{className:"circle"})))))},p=a(5),E=Object(p.b)((function(e){return{cats:e.catState.cats}}))((function(e){var t=e.cats,a=e.deleteHandler;return t.length?r.a.createElement("table",null,r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"\u2116"),r.a.createElement("th",null,"\u0418\u043c\u044f"),r.a.createElement("th",null,"\u0412\u043e\u0437\u0440\u0430\u0441\u0442"),r.a.createElement("th",null,"\u041e\u0442\u043a\u0440\u044b\u0442\u044c"),r.a.createElement("th",null,"X"))),r.a.createElement("tbody",null,t.map((function(e,t){return r.a.createElement("tr",{key:e.id},r.a.createElement("td",null,t+1),r.a.createElement("td",null,e.name),r.a.createElement("td",null,e.age),r.a.createElement("td",null,r.a.createElement(u.b,{to:"/cat/".concat(e.id)},"\u041f\u043e\u0434\u0440\u043e\u0431\u043d\u0435\u0435")),r.a.createElement("td",null,r.a.createElement("button",{onClick:function(){return a(e.id)}},"\u0423\u0434\u0430\u043b\u0438\u0442\u044c")))})))):r.a.createElement("p",{className:"center"},"\u041a\u043e\u0442\u043e\u0432 \u043f\u043e\u043a\u0430 \u043d\u0435\u0442")})),f=a(2);function b(e){return{type:"GET_CATS_SUCCESS",cats:e}}function h(e){return{type:"GET_CAT_SUCCESS",cat:e}}function v(e){return{type:"DELETE_CAT_SUCCESS",id:e}}var j=a(14),g=a(26),w={cats:[],cat:null,isLoading:!1},T=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:w,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"GET_CATS_SUCCESS":return Object(f.a)({},e,{cats:t.cats});case"GET_CAT_SUCCESS":return Object(f.a)({},e,{cat:t.cat});case"DELETE_CAT_SUCCESS":return Object(f.a)({},e,{cats:Object(g.a)(e.cats.filter((function(e){return e.id!==t.id})))});case"UPDATE_CAT_SUCCESS":return Object(f.a)({},e,{cat:t.cat});case"CAT_REQUEST_SENDING":return Object(f.a)({},e,{isLoading:!0});case"CAT_REQUEST_SENDED":return Object(f.a)({},e,{isLoading:!1})}return e},C={u_cat:{name:"",age:0},c_cat:{name:"",age:0}},k=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:C,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"UPDATE_CAT_PARAM_SET":return Object(f.a)({},e,{u_cat:{name:t.name,age:t.age}});case"CREATE_CAT_PARAM_SET":return Object(f.a)({},e,{c_cat:{name:t.name,age:t.age}})}return e},S={jwtToken:null,userName:null,isLoading:!1,isReady:!1},O=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:S,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"AUTH_USER_SUCCESS":return Object(f.a)({},e,{jwtToken:t.jwtToken,userName:t.userName});case"AUTH_REQUEST_SENDING":return Object(f.a)({},e,{isLoading:!0});case"AUTH_REQUEST_SENDED":return Object(f.a)({},e,{isLoading:!1});case"AUTH_TOKEN_READY":return Object(f.a)({},e,{isReady:!0})}return e},A={username:"",password:""},_=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:A,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"AUTH_PARAM_SET":return Object(f.a)({},e,{username:t.username,password:t.password})}return e},N=Object(j.b)({catState:T,catFormState:k,authState:O,authFormState:_}),y=Object(j.c)(N),x=function(){return Object(n.useCallback)(function(){var e=Object(m.a)(i.a.mark((function e(t,a,n){var r,c,l,u=arguments;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=u.length>3&&void 0!==u[3]?u[3]:{},y.dispatch({type:"CAT_REQUEST_SENDING"}),r=Object(f.a)({Accept:"application/json","Access-Control-Allow-Origin":"*","X-Requested-With":"XMLHttpRequest","Access-Control-Allow-Methods":"*","Access-Control-Allow-Headers":"Content-Type, Access-Control-Allow-Headers, Authorization, X-Requested-With"},r),e.prev=3,n&&(n=JSON.stringify(n),r["Content-type"]="application/json"),e.next=7,fetch(t,{method:a,body:n,headers:r});case 7:if(c=e.sent,l=Object(m.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,c.json();case 3:return e.abrupt("return",e.sent);case 6:return e.prev=6,e.t0=e.catch(0),e.abrupt("return",{});case 9:case"end":return e.stop()}}),e,null,[[0,6]])})))(),c.ok){e.next=11;break}throw new Error(l.message||"Something wrong");case 11:return y.dispatch({type:"CAT_REQUEST_SENDED"}),e.abrupt("return",l);case 15:throw e.prev=15,e.t0=e.catch(3),y.dispatch({type:"CAT_REQUEST_SENDED"}),e.t0;case 19:case"end":return e.stop()}}),e,null,[[3,15]])})));return function(t,a,n){return e.apply(this,arguments)}}(),[])},U=function(){var e=x(),t=Object(n.useCallback)(function(){var t=Object(m.a)(i.a.mark((function t(a){var n;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e("/api/cats","GET",null,{Authorization:"Bearer ".concat(a.jwtToken)});case 2:return n=t.sent,t.abrupt("return",n);case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),[]),a=Object(n.useCallback)(function(){var t=Object(m.a)(i.a.mark((function t(a){var n;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e("/api/cats/"+a.id,"GET",null,{Authorization:"Bearer ".concat(a.jwtToken)});case 2:return n=t.sent,t.abrupt("return",n);case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),[]),r=Object(n.useCallback)(function(){var t=Object(m.a)(i.a.mark((function t(a){return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e("/api/cats/"+a.id,"DELETE",null,{Authorization:"Bearer ".concat(a.jwtToken)});case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),[]);return{getCat:a,getCats:t,addCat:Object(n.useCallback)(function(){var t=Object(m.a)(i.a.mark((function t(a){return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e("/api/cats","POST",{name:a.name,age:a.age},{Authorization:"Bearer ".concat(a.jwtToken)});case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),[]),updateCat:Object(n.useCallback)(function(){var t=Object(m.a)(i.a.mark((function t(a){return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e("/api/cats","PUT",Object(f.a)({},a.cat),{Authorization:"Bearer ".concat(a.jwtToken)});case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),[]),deleteCat:r}},R=Object(p.b)((function(e){return{data:e.catState,creds:e.authState}}))((function(e){var t=U(),a=Object(n.useCallback)(Object(m.a)(i.a.mark((function a(){var n;return i.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,t.getCats({jwtToken:e.creds.jwtToken});case 2:n=a.sent,y.dispatch(b(n));case 4:case"end":return a.stop()}}),a)}))),[e.creds.jwtToken]),c=Object(n.useCallback)(function(){var a=Object(m.a)(i.a.mark((function a(n){return i.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,t.deleteCat({jwtToken:e.creds.jwtToken,id:n});case 2:y.dispatch(v(n));case 3:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}(),[e.creds.jwtToken]);return Object(n.useEffect)((function(){a()}),[e.creds.jwtToken]),e.data.isLoading?r.a.createElement(d,null):r.a.createElement(r.a.Fragment,null,!e.data.isLoading&&r.a.createElement(E,{deleteHandler:c}))})),D=a(11);function F(e){return{type:"UPDATE_CAT_PARAM_SET",name:e.name,age:parseInt(e.age)}}function H(e){return{type:"CREATE_CAT_PARAM_SET",name:e.name,age:parseInt(e.age)}}var L=Object(p.b)((function(e){return{form:e.catFormState.c_cat,creds:e.authState}}))((function(e){var t=Object(s.g)(),a=U();Object(n.useEffect)((function(){window.M.updateTextFields()}),[]);var c=Object(n.useCallback)((function(t){y.dispatch(H(Object(f.a)({},e.form,Object(D.a)({},t.target.name,t.target.value))))}),[e.form]),l=Object(n.useCallback)(function(){var n=Object(m.a)(i.a.mark((function n(r){return i.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if("Enter"!==r.key){n.next=6;break}return n.next=3,a.addCat(Object(f.a)({jwtToken:e.creds.jwtToken},e.form));case 3:n.sent,y.dispatch(H({name:"",age:0})),t.push("/cats");case 6:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),[e.form,e.creds.jwtToken]);return r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col s8 offset-s2",style:{paddingTop:"2rem"}},r.a.createElement("div",{className:"input-field"},r.a.createElement("input",{placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0438\u043c\u044f",id:"cat-name",name:"name",type:"text",value:e.form.name,onChange:c,onKeyPress:l}),r.a.createElement("label",{htmlFor:"cat-name"},"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0438\u043c\u044f")),r.a.createElement("div",{className:"input-field"},r.a.createElement("input",{placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0432\u043e\u0437\u0440\u0430\u0441\u0442",id:"cat-age",name:"age",type:"text",value:e.form.age,onChange:c,onKeyPress:l}),r.a.createElement("label",{htmlFor:"cat-age"},"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0432\u043e\u0437\u0440\u0430\u0441\u0442"))))})),P=Object(p.b)((function(e){return{form:e.catFormState.u_cat,cat:e.catState.cat}}))((function(e){var t=e.updateHandler,a=e.changeHandler,n=e.form,c=e.cat;return r.a.createElement(r.a.Fragment,null,r.a.createElement("h2",null,"Cat info"),r.a.createElement("p",null,r.a.createElement("b",null,"Id:")," ",c.id),r.a.createElement("p",null,r.a.createElement("b",null,"isAlive:")," ",c.isAlive.toString()),r.a.createElement("p",null,r.a.createElement("b",null,"Name:")," ",c.name.toString()),r.a.createElement("p",null,r.a.createElement("b",null,"Age:")," ",c.age.toString()),r.a.createElement("input",{id:"name",type:"text",name:"name",className:"yellow-input",value:n.name,onChange:a}),r.a.createElement("label",{htmlFor:"name"},"\u0418\u043c\u044f"),r.a.createElement("input",{id:"age",type:"text",name:"age",className:"yellow-input",value:n.age,onChange:a}),r.a.createElement("label",{htmlFor:"age"},"\u0412\u043e\u0437\u0440\u0430\u0441\u0442"),r.a.createElement("button",{onClick:t},"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u043a\u043e\u0442\u0430"))})),I=Object(p.b)((function(e){return{form:e.catFormState.u_cat,data:e.catState,creds:e.authState}}))((function(e){var t=Object(s.h)().id,a=U(),c=Object(n.useCallback)((function(t){y.dispatch(F(Object(f.a)({},e.form,Object(D.a)({},t.target.name,t.target.value))))}),[e.form]),l=Object(n.useCallback)(function(){var t=Object(m.a)(i.a.mark((function t(n){return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,a.updateCat({jwtToken:e.creds.jwtToken,cat:Object(f.a)({},e.data.cat,{},e.form)});case 2:y.dispatch({type:"UPDATE_CAT_SUCCESS",cat:Object(f.a)({},e.data.cat,{},e.form)});case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),[e.data.cat,e.form,e.creds.jwtToken]),u=Object(n.useCallback)(function(){var e=Object(m.a)(i.a.mark((function e(t,n){var r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.getCat({jwtToken:t,id:n});case 2:r=e.sent,y.dispatch(h(r)),y.dispatch(F({name:r.name,age:r.age}));case 5:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),[]);return Object(n.useEffect)((function(){u(e.creds.jwtToken,t)}),[e.creds.jwtToken,t]),e.data.isLoading?r.a.createElement(d,null):r.a.createElement(r.a.Fragment,null,!e.data.isLoading&&e.data.cat&&r.a.createElement(P,{changeHandler:c,updateHandler:l}))}));function M(e){return{type:"AUTH_USER_SUCCESS",jwtToken:e.jwtToken,userName:e.userName}}var G=function(){var e=Object(n.useCallback)((function(e,t){console.log("dispatching login",{jwtToken:e,userName:t}),y.dispatch(M({jwtToken:e,userName:t})),localStorage.setItem("userData",JSON.stringify({jwtToken:e,userName:t}))}),[]),t=Object(n.useCallback)((function(){y.dispatch(M({jwtToken:null,userName:null})),localStorage.removeItem("userData")}),[]);return Object(n.useEffect)((function(){var t=JSON.parse(localStorage.getItem("userData"));t&&t.jwtToken&&e(t.jwtToken,t.userName),y.dispatch({type:"AUTH_TOKEN_READY"})}),[e]),{login:e,logout:t}};var Q=Object(p.b)((function(e){return{form:e.authFormState,creds:e.authState}}))((function(e){var t=G(),a=function(){var e=x();return{getToken:Object(n.useCallback)(function(){var t=Object(m.a)(i.a.mark((function t(a){var n;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e("/api/account/token","POST",a,{});case 2:return n=t.sent,t.abrupt("return",n);case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),[])}}();Object(n.useEffect)((function(){window.M.updateTextFields()}),[]);var c=Object(n.useCallback)((function(t){var a;y.dispatch({type:"AUTH_PARAM_SET",username:(a=Object(f.a)({},e.form,Object(D.a)({},t.target.name,t.target.value))).username,password:a.password})}),[e.form]),l=Object(n.useCallback)(Object(m.a)(i.a.mark((function n(){var r;return i.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,a.getToken(e.form);case 3:r=n.sent,t.login(r.token,r.userName),n.next=10;break;case 7:n.prev=7,n.t0=n.catch(0),alert(n.t0.message);case 10:case"end":return n.stop()}}),n,null,[[0,7]])}))),[e.form]);return r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col s6 offset-s3"},r.a.createElement("h1",null,"CRUD \u041a\u043e\u0442\u043e\u0432"),r.a.createElement("div",{className:"card blue darken-1"},r.a.createElement("div",{className:"card-content white-text"},r.a.createElement("span",{className:"card-title"},"\u0410\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u044f"),r.a.createElement("div",null,r.a.createElement("div",{className:"input-field"},r.a.createElement("input",{placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 login",id:"username",type:"text",name:"username",className:"yellow-input",value:e.form.username,onChange:c}),r.a.createElement("label",{htmlFor:"username"},"\u041b\u043e\u0433\u0438\u043d")),r.a.createElement("div",{className:"input-field"},r.a.createElement("input",{placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043f\u0430\u0440\u043e\u043b\u044c",id:"password",type:"password",name:"password",className:"yellow-input",value:e.form.password,onChange:c}),r.a.createElement("label",{htmlFor:"email"},"\u041f\u0430\u0440\u043e\u043b\u044c")))),r.a.createElement("div",{className:"card-action"},r.a.createElement("button",{className:"btn yellow darken-4",style:{marginRight:10},disabled:e.creds.isLoading,onClick:l},"\u0412\u043e\u0439\u0442\u0438")))))})),z=Object(p.b)((function(e){return{creds:e.authState}}))((function(e){var t=Object(s.g)(),a=G();return r.a.createElement("nav",null,r.a.createElement("div",{className:"nav-wrapper blue darken-1"},r.a.createElement("span",{className:"brand-logo"},"CRUD \u041a\u043e\u0442\u043e\u0432, ",r.a.createElement("b",null,e.creds.userName)),r.a.createElement("ul",{id:"nav-mobile",className:"right hide-on-med-and-down"},r.a.createElement("li",null,r.a.createElement(u.c,{to:"/create"},"\u0421\u043e\u0437\u0434\u0430\u0442\u044c")),r.a.createElement("li",null,r.a.createElement(u.c,{to:"/cats"},"\u0421\u043f\u0438\u0441\u043e\u043a \u043a\u043e\u0442\u043e\u0432")),r.a.createElement("li",null,r.a.createElement("a",{href:"/",onClick:function(e){e.preventDefault(),a.logout(),t.push("/")}},"\u0412\u044b\u0439\u0442\u0438")))))}));a(39);var B=Object(p.b)((function(e){return{creds:e.authState}}))((function(e){G();var t=!!e.creds.jwtToken,a=function(e){return e?r.a.createElement(s.d,null,r.a.createElement(s.b,{path:"/cats",exact:!0},r.a.createElement(R,null)),r.a.createElement(s.b,{path:"/create",exact:!0},r.a.createElement(L,null)),r.a.createElement(s.b,{path:"/cat/:id"},r.a.createElement(I,null)),r.a.createElement(s.a,{to:"/create"})):r.a.createElement(s.d,null,r.a.createElement(s.b,{path:"/",exact:!0},r.a.createElement(Q,null)),r.a.createElement(s.a,{to:"/"}))}(t);return e.creds.isReady?r.a.createElement(u.a,null,t&&r.a.createElement(z,null),r.a.createElement("div",{className:"container"},a)):r.a.createElement(d,null)}));l.a.render(r.a.createElement(p.a,{store:y},r.a.createElement(B,null)),document.getElementById("root"))}},[[27,1,2]]]);
//# sourceMappingURL=main.2218d369.chunk.js.map