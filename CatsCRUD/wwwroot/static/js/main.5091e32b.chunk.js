(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{33:function(e,t,a){e.exports=a(46)},38:function(e,t,a){},46:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(20),u=a.n(c),s=(a(38),a(13)),l=a(17),o=a(2),i=a.n(o),m=a(7),d=function(){return r.a.createElement("div",null,r.a.createElement("div",{className:"preloader-wrapper active"},r.a.createElement("div",{className:"spinner-layer spinner-red-only"},r.a.createElement("div",{className:"circle-clipper left"},r.a.createElement("div",{className:"circle"})),r.a.createElement("div",{className:"gap-patch"},r.a.createElement("div",{className:"circle"})),r.a.createElement("div",{className:"circle-clipper right"},r.a.createElement("div",{className:"circle"})))))},p=a(8),f=Object(p.b)((function(e){return{cats:e.catState.cats}}))((function(e){var t=e.cats,a=e.deleteHandler;return t.length?r.a.createElement("table",null,r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"\u2116"),r.a.createElement("th",null,"\u0418\u043c\u044f"),r.a.createElement("th",null,"\u0412\u043e\u0437\u0440\u0430\u0441\u0442"),r.a.createElement("th",null,"\u041e\u0442\u043a\u0440\u044b\u0442\u044c"),r.a.createElement("th",null,"X"))),r.a.createElement("tbody",null,t.map((function(e,t){return r.a.createElement("tr",{key:e.id},r.a.createElement("td",null,t+1),r.a.createElement("td",null,e.name),r.a.createElement("td",null,e.age),r.a.createElement("td",null,r.a.createElement(s.b,{to:"/cat/".concat(e.id)},"\u041f\u043e\u0434\u0440\u043e\u0431\u043d\u0435\u0435")),r.a.createElement("td",null,r.a.createElement("button",{onClick:function(){return a(e.id)}},"\u0423\u0434\u0430\u043b\u0438\u0442\u044c")))})))):r.a.createElement("p",{className:"center"},"\u041a\u043e\u0442\u043e\u0432 \u043f\u043e\u043a\u0430 \u043d\u0435\u0442")})),b=a(15),E=a(31),h=a(4),v="REQUEST",O="SUCCESS";function g(e){return[v,O].reduce((function(t,a){return t[a]="".concat(e,"_").concat(a),t}),{})}var j=g("CAT_GETS"),w=g("CAT_GET"),x=g("CAT_UPDATE"),k=g("CAT_DELETE"),T=g("CAT_CREATE"),N=g("TOKEN_GET");function C(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object(h.a)({type:e},t)}var y=function(){return C(j[v])},A=function(e){return C(j[O],{cats:e})},S=function(e){return C(w[v],{id:e})},_=function(e){return C(w[O],Object(h.a)({},e))},F=function(e){return C(x[v],Object(h.a)({},e))},R=function(e){return C(x[O],Object(h.a)({},e))},D=function(e){return C(k[v],{id:e})},L=function(e){return C(k[O],{id:e})},U=function(e){return C(T[v],Object(h.a)({},e))},P=function(){return C(T[O])},M=function(e){return C(N[v],Object(h.a)({},e))},H=function(e){return C(N[O],Object(h.a)({},e))},I=function(e){return C("UPDATE_CAT_CREATING_FORM",Object(h.a)({},e))},G=function(e){return C("UPDATE_CAT_UPDATING_FORM",Object(h.a)({},e))},K={cats:[],cat:null,isLoading:!1},J=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:K,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case j[v]:case w[v]:case x[v]:case k[v]:case T[v]:return Object(h.a)({},e,{isLoading:!0});case j[O]:return Object(h.a)({},e,{cats:t.cats,isLoading:!1});case w[O]:return Object(h.a)({},e,{cat:t.cat,isLoading:!1});case k[O]:return Object(h.a)({},e,{cats:Object(E.a)(e.cats.filter((function(e){return e.id!==t.id}))),isLoading:!1});case x[O]:return Object(h.a)({},e,{cat:t.cat,isLoading:!1});case T[O]:return Object(h.a)({},e,{isLoading:!1})}return e},X={u_cat:{name:"",age:0},c_cat:{name:"",age:0}},q=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:X,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"UPDATE_CAT_CREATING_FORM":return Object(h.a)({},e,{c_cat:{name:t.name,age:t.age}});case"UPDATE_CAT_UPDATING_FORM":return Object(h.a)({},e,{u_cat:{name:t.name,age:t.age}})}return e},z=function(e,t){localStorage.setItem("userData",JSON.stringify({jwtToken:e,userName:t}))},B=function(){var e=JSON.parse(localStorage.getItem("userData"));return e?{jwtToken:e.jwtToken||null,userName:e.userName||null}:{jwtToken:null,userName:null}},V=function(){localStorage.removeItem("userData")},W=function(){return Object(n.useEffect)((function(){var e=B();e.jwtToken&&De.dispatch(H({jwtToken:e.jwtToken,userName:e.userName})),De.dispatch(C("TOKEN_READY"))}),[B]),{setToLocalSorage:z,removeFromLocalSorage:V,getJwtTokenData:B}},Y={jwtToken:null,userName:null,isLoading:!1,isReady:!1},Q=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Y,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case N[O]:return z(t.jwtToken,t.userName),Object(h.a)({},e,{jwtToken:t.jwtToken,userName:t.userName,isLoading:!1});case"TOKEN_REMOVE":return V(),Object(h.a)({},e,{jwtToken:null,userName:null});case N[v]:return Object(h.a)({},e,{isLoading:!0});case"TOKEN_READY":return Object(h.a)({},e,{isReady:!0})}return e},Z={username:"",password:""},$=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Z,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"UPDATE_AUTH_FORM":return Object(h.a)({},e,{username:t.username,password:t.password})}return e},ee=Object(b.c)({catState:J,catFormState:q,authState:Q,authFormState:$}),te=a(32),ae=a(9),ne=function(e){return function(){var t=Object(m.a)(i.a.mark((function t(a,n,r){var c,u,s,l=arguments;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return c=l.length>3&&void 0!==l[3]?l[3]:{},console.log(a,r),c=Object(h.a)({Accept:"application/json","Access-Control-Allow-Origin":"*","X-Requested-With":"XMLHttpRequest","Access-Control-Allow-Methods":"*","Access-Control-Allow-Headers":"Content-Type, Access-Control-Allow-Headers, Authorization, X-Requested-With"},c),t.prev=3,e&&(c=Object(h.a)({},c,{Authorization:"Bearer ".concat(e)})),r&&(r=JSON.stringify(r),c["Content-type"]="application/json"),t.next=8,fetch(a,{method:n,body:r,headers:c});case 8:if(u=t.sent,s=Object(m.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,u.json();case 3:return e.abrupt("return",e.sent);case 6:return e.prev=6,e.t0=e.catch(0),e.abrupt("return",{});case 9:case"end":return e.stop()}}),e,null,[[0,6]])})))(),u.ok){t.next=12;break}throw new Error(s.message||"Something wrong");case 12:return t.abrupt("return",s);case 15:throw t.prev=15,t.t0=t.catch(3),t.t0;case 18:case"end":return t.stop()}}),t,null,[[3,15]])})));return function(e,a,n){return t.apply(this,arguments)}}()},re=i.a.mark(Oe),ce=i.a.mark(ge),ue=i.a.mark(je),se=i.a.mark(we),le=i.a.mark(xe),oe=i.a.mark(ke),ie=i.a.mark(Te),me=i.a.mark(Ne),de=i.a.mark(Ce),pe=i.a.mark(ye),fe=i.a.mark(Ae),be=i.a.mark(Se),Ee=i.a.mark(_e),he=function(e){var t=ne(e),a=function(){var e=Object(m.a)(i.a.mark((function e(){var a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t("/api/cats","GET");case 2:return a=e.sent,e.abrupt("return",a);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),n=function(){var e=Object(m.a)(i.a.mark((function e(a){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t("/api/cats/"+a.id,"GET");case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),r=function(){var e=Object(m.a)(i.a.mark((function e(a){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t("/api/cats/"+a.id,"DELETE");case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return{getCat:n,getCats:a,addCat:function(){var e=Object(m.a)(i.a.mark((function e(a){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t("/api/cats","POST",{name:a.name,age:parseInt(a.age)});case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),updateCat:function(){var e=Object(m.a)(i.a.mark((function e(a){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t("/api/cats","PUT",{id:a.cat.id,name:a.cat.name,age:parseInt(a.cat.age)});case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),deleteCat:r}}(B().jwtToken),ve=function(){var e=ne();return{getToken:function(){var t=Object(m.a)(i.a.mark((function t(a){var n;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e("/api/account/token","POST",a,{});case 2:return n=t.sent,t.abrupt("return",n);case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}}();function Oe(){var e;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,he.getCats();case 2:return e=t.sent,t.next=5,Object(ae.b)(A(e));case 5:case"end":return t.stop()}}),re)}function ge(e){var t;return i.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,he.getCat({id:e.id});case 2:return t=a.sent,a.next=5,Object(ae.b)(_({cat:t}));case 5:return a.next=7,Object(ae.b)(G(t));case 7:case"end":return a.stop()}}),ce)}function je(e){return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,he.addCat({name:e.name,age:e.age});case 2:return t.next=4,Object(ae.b)(P());case 4:return t.next=6,Object(ae.b)(I({name:"",age:""}));case 6:return t.next=8,Object(ae.b)(y());case 8:case"end":return t.stop()}}),ue)}function we(e){return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,he.updateCat({cat:{id:e.id,name:e.name,age:e.age,isAlive:e.isAlive}});case 2:return t.next=4,Object(ae.b)(R({cat:{id:e.id,name:e.name,age:e.age,isAlive:e.isAlive}}));case 4:case"end":return t.stop()}}),se)}function xe(e){return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,he.deleteCat({id:e.id});case 2:return t.next=4,Object(ae.b)(L(e.id));case 4:case"end":return t.stop()}}),le)}function ke(e){var t;return i.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,ve.getToken({username:e.username,password:e.password});case 2:return t=a.sent,a.next=5,Object(ae.b)(H({jwtToken:t.token,userName:t.userName}));case 5:case"end":return a.stop()}}),oe)}function Te(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(ae.c)(j[v],Oe);case 2:case"end":return e.stop()}}),ie)}function Ne(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(ae.c)(w[v],ge);case 2:case"end":return e.stop()}}),me)}function Ce(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(ae.c)(T[v],je);case 2:case"end":return e.stop()}}),de)}function ye(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(ae.c)(x[v],we);case 2:case"end":return e.stop()}}),pe)}function Ae(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(ae.c)(k[v],xe);case 2:case"end":return e.stop()}}),fe)}function Se(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(ae.c)(N[v],ke);case 2:case"end":return e.stop()}}),be)}function _e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(ae.a)([Te(),Ne(),Ce(),ye(),Ae(),Se()]);case 2:case"end":return e.stop()}}),Ee)}var Fe=Object(te.a)(),Re=Object(b.e)(ee,Object(b.a)(Fe));Fe.run(_e);var De=Re,Le=Object(p.b)((function(e){return{data:e.catState,creds:e.authState}}))((function(e){var t=Object(n.useCallback)(function(){var e=Object(m.a)(i.a.mark((function e(t){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:De.dispatch(D(t));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[]);return Object(n.useEffect)((function(){De.dispatch(y())}),[]),e.data.isLoading?r.a.createElement(d,null):r.a.createElement(r.a.Fragment,null,!e.data.isLoading&&r.a.createElement(f,{deleteHandler:t}))})),Ue=a(16),Pe=Object(p.b)((function(e){return{form:e.catFormState.c_cat,creds:e.authState}}))((function(e){var t=Object(l.g)();Object(n.useEffect)((function(){window.M.updateTextFields()}),[]);var a=Object(n.useCallback)((function(t){De.dispatch(I(Object(h.a)({},e.form,Object(Ue.a)({},t.target.name,t.target.value))))}),[e.form]),c=Object(n.useCallback)(function(){var a=Object(m.a)(i.a.mark((function a(n){return i.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:"Enter"===n.key&&(De.dispatch(U(e.form)),t.push("/cats"));case 1:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}(),[e.form]);return r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col s8 offset-s2",style:{paddingTop:"2rem"}},r.a.createElement("div",{className:"input-field"},r.a.createElement("input",{placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0438\u043c\u044f",id:"cat-name",name:"name",type:"text",value:e.form.name,onChange:a,onKeyPress:c}),r.a.createElement("label",{htmlFor:"cat-name"},"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0438\u043c\u044f")),r.a.createElement("div",{className:"input-field"},r.a.createElement("input",{placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0432\u043e\u0437\u0440\u0430\u0441\u0442",id:"cat-age",name:"age",type:"text",value:e.form.age,onChange:a,onKeyPress:c}),r.a.createElement("label",{htmlFor:"cat-age"},"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0432\u043e\u0437\u0440\u0430\u0441\u0442"))))})),Me=Object(p.b)((function(e){return{form:e.catFormState.u_cat,cat:e.catState.cat}}))((function(e){var t=e.updateHandler,a=e.changeHandler,n=e.form,c=e.cat;return r.a.createElement(r.a.Fragment,null,r.a.createElement("h2",null,"Cat info"),r.a.createElement("p",null,r.a.createElement("b",null,"Id:")," ",c.id),r.a.createElement("p",null,r.a.createElement("b",null,"isAlive:")," ",c.isAlive.toString()),r.a.createElement("p",null,r.a.createElement("b",null,"Name:")," ",c.name.toString()),r.a.createElement("p",null,r.a.createElement("b",null,"Age:")," ",c.age.toString()),r.a.createElement("input",{id:"name",type:"text",name:"name",className:"yellow-input",value:n.name,onChange:a}),r.a.createElement("label",{htmlFor:"name"},"\u0418\u043c\u044f"),r.a.createElement("input",{id:"age",type:"text",name:"age",className:"yellow-input",value:n.age,onChange:a}),r.a.createElement("label",{htmlFor:"age"},"\u0412\u043e\u0437\u0440\u0430\u0441\u0442"),r.a.createElement("button",{onClick:t},"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u043a\u043e\u0442\u0430"))})),He=Object(p.b)((function(e){return{form:e.catFormState.u_cat,data:e.catState,creds:e.authState}}))((function(e){var t=Object(l.h)().id,a=Object(n.useCallback)((function(t){De.dispatch(G(Object(h.a)({},e.form,Object(Ue.a)({},t.target.name,t.target.value))))}),[e.form]),c=Object(n.useCallback)(function(){var t=Object(m.a)(i.a.mark((function t(a){return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:De.dispatch(F(Object(h.a)({},e.data.cat,{},e.form)));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),[e.data.cat,e.form]);return Object(n.useEffect)((function(){De.dispatch(S(t))}),[t]),e.data.isLoading?r.a.createElement(d,null):r.a.createElement(r.a.Fragment,null,!e.data.isLoading&&e.data.cat&&r.a.createElement(Me,{changeHandler:a,updateHandler:c}))})),Ie=Object(p.b)((function(e){return{form:e.authFormState,creds:e.authState}}))((function(e){Object(n.useEffect)((function(){window.M.updateTextFields()}),[]);var t=Object(n.useCallback)((function(t){var a;De.dispatch((a=Object(h.a)({},e.form,Object(Ue.a)({},t.target.name,t.target.value)),C("UPDATE_AUTH_FORM",Object(h.a)({},a))))}),[e.form]),a=Object(n.useCallback)(Object(m.a)(i.a.mark((function t(){return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:try{De.dispatch(M(e.form))}catch(a){alert(a.message)}case 1:case"end":return t.stop()}}),t)}))),[e.form]);return r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col s6 offset-s3"},r.a.createElement("h1",null,"CRUD \u041a\u043e\u0442\u043e\u0432"),r.a.createElement("div",{className:"card blue darken-1"},r.a.createElement("div",{className:"card-content white-text"},r.a.createElement("span",{className:"card-title"},"\u0410\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u044f"),r.a.createElement("div",null,r.a.createElement("div",{className:"input-field"},r.a.createElement("input",{placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 login",id:"username",type:"text",name:"username",className:"yellow-input",value:e.form.username,onChange:t}),r.a.createElement("label",{htmlFor:"username"},"\u041b\u043e\u0433\u0438\u043d")),r.a.createElement("div",{className:"input-field"},r.a.createElement("input",{placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043f\u0430\u0440\u043e\u043b\u044c",id:"password",type:"password",name:"password",className:"yellow-input",value:e.form.password,onChange:t}),r.a.createElement("label",{htmlFor:"email"},"\u041f\u0430\u0440\u043e\u043b\u044c")))),r.a.createElement("div",{className:"card-action"},r.a.createElement("button",{className:"btn yellow darken-4",style:{marginRight:10},disabled:e.creds.isLoading,onClick:a},"\u0412\u043e\u0439\u0442\u0438")))))})),Ge=Object(p.b)((function(e){return{creds:e.authState}}))((function(e){var t=Object(l.g)();return r.a.createElement("nav",null,r.a.createElement("div",{className:"nav-wrapper blue darken-1"},r.a.createElement("span",{className:"brand-logo"},"CRUD \u041a\u043e\u0442\u043e\u0432, ",r.a.createElement("b",null,e.creds.userName)),r.a.createElement("ul",{id:"nav-mobile",className:"right hide-on-med-and-down"},r.a.createElement("li",null,r.a.createElement(s.c,{to:"/create"},"\u0421\u043e\u0437\u0434\u0430\u0442\u044c")),r.a.createElement("li",null,r.a.createElement(s.c,{to:"/cats"},"\u0421\u043f\u0438\u0441\u043e\u043a \u043a\u043e\u0442\u043e\u0432")),r.a.createElement("li",null,r.a.createElement("a",{href:"/",onClick:function(e){e.preventDefault(),De.dispatch(C("TOKEN_REMOVE")),t.push("/")}},"\u0412\u044b\u0439\u0442\u0438")))))}));a(45);var Ke=Object(p.b)((function(e){return{creds:e.authState}}))((function(e){W();var t=!!B().jwtToken,a=function(e){return e?r.a.createElement(l.d,null,r.a.createElement(l.b,{path:"/cats",exact:!0},r.a.createElement(Le,null)),r.a.createElement(l.b,{path:"/create",exact:!0},r.a.createElement(Pe,null)),r.a.createElement(l.b,{path:"/cat/:id"},r.a.createElement(He,null)),r.a.createElement(l.a,{to:"/create"})):r.a.createElement(l.d,null,r.a.createElement(l.b,{path:"/",exact:!0},r.a.createElement(Ie,null)),r.a.createElement(l.a,{to:"/"}))}(t);return e.creds.isReady?r.a.createElement(s.a,null,t&&r.a.createElement(Ge,null),r.a.createElement("div",{className:"container"},a)):r.a.createElement(d,null)}));u.a.render(r.a.createElement(p.a,{store:De},r.a.createElement(Ke,null)),document.getElementById("root"))}},[[33,1,2]]]);
//# sourceMappingURL=main.5091e32b.chunk.js.map